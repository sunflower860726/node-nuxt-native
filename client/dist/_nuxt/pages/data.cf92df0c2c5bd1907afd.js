/*! For license information please see LICENSES */
webpackJsonp([1],{"812o":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"section"},[a("div",{staticClass:"container"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("div",{staticStyle:{"background-color":"#f4f4f4",padding:"10px"}},[a("b-field",{attrs:{label:"Patients"}},[a("b-taginput",{attrs:{autocomplete:"",disabled:t.aggregate,data:t.filteredPatients,icon:"label",placeholder:"Add a tag",field:"title","open-on-focus":t.openOnFocus},on:{typing:t.getFilteredPatients},model:{value:t.selectedPatients,callback:function(e){t.selectedPatients=e},expression:"selectedPatients"}})],1)],1)]),a("div",{staticClass:"column is-one-fifth"},[a("div",{staticStyle:{"background-color":"#f4f4f4",padding:"10px"}},[a("b-field",{attrs:{label:"Start date"}},[a("b-datepicker",{attrs:{placeholder:"Click to select...",icon:"calendar-today"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1)],1)]),a("div",{staticClass:"column is-one-fifth"},[a("div",{staticStyle:{"background-color":"#f4f4f4",padding:"10px"}},[a("b-field",{attrs:{label:"End date"}},[a("b-datepicker",{attrs:{placeholder:"Click to select...",icon:"calendar-today",position:"is-bottom-left"},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)],1)])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("b-checkbox",{model:{value:t.aggregate,callback:function(e){t.aggregate=e},expression:"aggregate"}},[t._v("Aggregate")])],1)])]),a("div",{staticClass:"container"},[t.allowDownload?a("div",{staticClass:"level is-mobile",staticStyle:{"min-height":"200px","line-height":"200px"}},[a("div",{staticClass:"level-item has-text-centered"},[a("a",{staticClass:"button is-primary",on:{click:function(e){t.downloadUAS()}}},[t._v("UAS")]),a("a",{staticClass:"button is-primary",staticStyle:{"margin-left":"10px"},on:{click:function(e){t.downloadAAS()}}},[t._v("AAS")]),a("a",{staticClass:"button is-primary",staticStyle:{"margin-left":"10px"},on:{click:function(e){t.downloadCT()}}},[t._v("Control Test")]),a("a",{staticClass:"button is-primary",staticStyle:{"margin-left":"10px"},on:{click:function(e){t.downloadUQOL()}}},[t._v("Urticaria Quality of life")]),a("a",{staticClass:"button is-primary",staticStyle:{"margin-left":"10px"},on:{click:function(e){t.downloadAQOL()}}},[t._v("Angioedema Quality of life")])])]):a("div",{staticClass:"has-text-centered",staticStyle:{"min-height":"200px","line-height":"200px"}},[t._v("\n        Select information to retrieve data.\n      ")])])])};n._withStripped=!0;var i={render:n,staticRenderFns:[]};e.a=i},LGuY:function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},MxIP:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".input,.taginput .taginput-container.is-focusable,.textarea{-webkit-box-shadow:none;box-shadow:none}.taginput .taginput-container.is-focusable{height:2.25em;padding-top:0;padding-bottom:0}",""])},Oog6:function(t,e,a){var n=a("MxIP");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("4f0d8865",n,!1,{sourceMap:!1})},VylR:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("zaap"),i=a("812o"),s=!1;var o=function(t){s||a("Oog6")},r=a("VU/8")(n.a,i.a,!1,o,null,null);r.options.__file="pages/data.vue",e.default=r.exports},lDdF:function(t,e,a){var n,i=i||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=function(){return t.URL||t.webkitURL||t},a=t.document.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in a,i=/constructor/i.test(t.HTMLElement)||t.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),o=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},r=function(t){setTimeout(function(){"string"==typeof t?e().revokeObjectURL(t):t.remove()},4e4)},c=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},l=function(l,d,u){u||(l=c(l));var f,g=this,p="application/octet-stream"===l.type,h=function(){!function(t,e,a){for(var n=(e=[].concat(e)).length;n--;){var i=t["on"+e[n]];if("function"==typeof i)try{i.call(t,a||t)}catch(t){o(t)}}}(g,"writestart progress write writeend".split(" "))};if(g.readyState=g.INIT,n)return f=e().createObjectURL(l),void setTimeout(function(){a.href=f,a.download=d,function(t){var e=new MouseEvent("click");t.dispatchEvent(e)}(a),h(),r(f),g.readyState=g.DONE});!function(){if((s||p&&i)&&t.FileReader){var a=new FileReader;return a.onloadend=function(){var e=s?a.result:a.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,g.readyState=g.DONE,h()},a.readAsDataURL(l),void(g.readyState=g.INIT)}f||(f=e().createObjectURL(l)),p?t.location.href=f:t.open(f,"_blank")||(t.location.href=f);g.readyState=g.DONE,h(),r(f)}()},d=l.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,a){return e=e||t.name||"download",a||(t=c(t)),navigator.msSaveOrOpenBlob(t,e)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(t,e,a){return new l(t,e||t.name||"download",a)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==t&&t.exports?t.exports.saveAs=i:null!==a("LGuY")&&null!==a("nErl")&&(void 0===(n=function(){return i}.call(e,a,e,t))||(t.exports=n))},nErl:function(t,e){(function(e){t.exports=e}).call(e,{})},zaap:function(t,e,a){"use strict";var n=a("Dd8w"),i=a.n(n),s=a("NYxO"),o=a("Eoz/"),r=a.n(o),c=a("lDdF");a.n(c);e.a={layout:"authenticated",data:function(){return{filteredPatients:[],selectedPatients:[],selectedPatientsMap:{},startDate:null,endDate:null,openOnFocus:!0,aggregate:!1}},mounted:function(){var t=this;this.findPatients().then(function(e){t.filteredPatients=t.formattedPatients}).catch(function(e){console.log(e.message),e&&401===e.code&&t.$router.push("login")})},computed:i()({},Object(s.mapGetters)({patients:"patients/list"}),{formattedPatients:function(){return this.patients.filter(function(t){return t.generalConsent}).map(function(t){return{patient:t,title:t.name+"<"+t.email+">"}})},allowDownload:function(){return(this.selectedPatients.length>0||this.aggregate)&&this.startDate&&this.endDate}}),methods:i()({},Object(s.mapActions)({findPatients:"patients/find",getUAS:"uas/find",getAAS:"aas/find",getCT:"ct/find",getUQOL:"uqol/find",getAQOL:"aqol/find"}),{getFilteredPatients:function(t){this.filteredPatients=this.formattedPatients.filter(function(t){return t.generalConsent}).filter(function(e){return e.title.indexOf(t)>-1})},downloadUAS:function(){var t=this,e=this.selectedPatients.map(function(t){return t.patient._id}),a={startDate:r()(this.startDate,"YYYY-MM-DD"),endDate:r()(this.endDate,"YYYY-MM-DD")};this.aggregate?a.aggregate=!0:a.patients=e,this.getUAS({query:a}).then(function(e){t.uasToCSV(e,t.aggregate)})},downloadAAS:function(){var t=this,e=this.selectedPatients.map(function(t){return t.patient._id}),a={startDate:r()(this.startDate,"YYYY-MM-DD"),endDate:r()(this.endDate,"YYYY-MM-DD")};this.aggregate?a.aggregate=!0:a.patients=e,this.getAAS({query:a}).then(function(e){t.aasToCSV(e,t.aggregate)})},downloadCT:function(){var t=this,e=this.selectedPatients.map(function(t){return t.patient._id}),a={startDate:r()(this.startDate,"YYYY-MM-DD"),endDate:r()(this.endDate,"YYYY-MM-DD")};this.aggregate?a.aggregate=!0:a.patients=e,this.getCT({query:a}).then(function(e){t.resultsToCSV(e,"ct.csv",t.aggregate)})},downloadUQOL:function(){var t=this,e=this.selectedPatients.map(function(t){return t.patient._id}),a={startDate:r()(this.startDate,"YYYY-MM-DD"),endDate:r()(this.endDate,"YYYY-MM-DD")};this.aggregate?a.aggregate=!0:a.patients=e,this.getUQOL({query:a}).then(function(e){t.resultsToCSV(e,"uqol.csv",t.aggregate)})},downloadAQOL:function(){var t=this,e=this.selectedPatients.map(function(t){return t.patient._id}),a={startDate:r()(this.startDate,"YYYY-MM-DD"),endDate:r()(this.endDate,"YYYY-MM-DD")};this.aggregate?a.aggregate=!0:a.patients=e,this.getAQOL({query:a}).then(function(e){t.resultsToCSV(e,"aqol.csv",t.aggregate)})},objectToCSV:function(t,e){var a="";return t.forEach(function(t){a+=e(t)+"\n"}),a},uasToCSV:function(t,e){var a=this,n="";n=e?"Date,Hive,Itch\n":"Patient,Date,Hive,Itch\n",n+=this.objectToCSV(t,function(t){var n="";e||(n=a.selectedPatientsMap[t.patientId].name+",");return n+t.date+","+t.hive+","+t.itch});var i=new Blob([n],{type:"text/csv;charset=utf-8"});c.saveAs(i,"uas.csv")},aasToCSV:function(t,e){var a=this,n="";n=e?"Date,Q1,Q2,Q3,Q4\n":"Patient,Date,Q1,Q2,Q3,Q4\n",n+=this.objectToCSV(t,function(t){var n="";e||(n=a.selectedPatientsMap[t.patientId].name+",");return n+t.date+","+t.results[0]+","+t.results[1]+","+t.results[2]+","+t.results[3]});var i=new Blob([n],{type:"text/csv;charset=utf-8"});c.saveAs(i,"aas.csv")},resultsToCSV:function(t,e,a){var n=this,i="";if(i=a?"Date,Results\n":"Patient,Date,Results\n",t.length>0){i+=this.objectToCSV(t,function(t){var e="";a||(e=n.selectedPatientsMap[t.patientId].name+",");return e+t.date+","+t.results})}var s=new Blob([i],{type:"text/csv;charset=utf-8"});c.saveAs(s,e)}}),watch:{selectedPatients:function(){var t={};this.selectedPatients.forEach(function(e){t[e.patient._id]=e.patient}),this.selectedPatientsMap=t},startDate:function(){},endDate:function(){}}}}});